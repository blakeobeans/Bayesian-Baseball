"0","pred <- NULL"
"0","pred <- data.frame(""LB"" = c("
"0","  quantile(game1.posterior$V1, 0.025), "
"0","  quantile(game2.posterior$V2, 0.025), "
"0","  quantile(game3.posterior$V3, 0.025), "
"0","  quantile(game4.posterior$V4, 0.025), "
"0","  quantile(game5.posterior$V5, 0.025)) "
"0","  ,"
"0","  ""UB"" = c("
"0","  quantile(game1.posterior$V1, 0.975), "
"0","  quantile(game2.posterior$V2, 0.975),"
"0","  quantile(game3.posterior$V3, 0.975), "
"0","  quantile(game4.posterior$V4, 0.975), "
"0","  quantile(game5.posterior$V5, 0.975))"
"0","  ,"
"0","  ""Mean"" = c("
"0","  mean(game1.posterior$V1), "
"0","  mean(game2.posterior$V2), "
"0","  mean(game3.posterior$V3), "
"0","  mean(game4.posterior$V4), "
"0","  mean(game5.posterior$V5))"
"0","  ,"
"0","  ""Game"" = c(1:5)) "
"0","###pooled means"
"0","hometeam = ""LAD"""
"0","home.pooled.mean <- mydata %>% filter(home == hometeam) %>% select(rdiff)"
"0","home.pooled.mean <- mean(home.pooled.mean$rdiff)"
"0","awayteam = ""LAD"""
"0","away.pooled.mean <- mydata %>% filter(away == awayteam) %>% select(rdiff)"
"0","away.pooled.mean <- mean(away.pooled.mean$rdiff) * -1 #reverse rdiff"
"0","pred$pool <- c(rep(away.pooled.mean, 2), rep(home.pooled.mean, 3))"
"0","###partially pooled"
"0","pred2 <- NULL"
"0","pred2$Mean = c(-0.444, -3.796, 1.26, 1, 1.2, 0.84, 0.84, 2.3, 2.3, 2.3, -4, -5, .5, -3, -4)"
"0","pred2$Game = c(1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5)"
"0","pred2$LB = rep(pred$LB, 3)"
"0","pred2$UB = rep(pred$UB, 3)"
"0","pred2$Model <- c(rep(c(""Partial Pooling""), 5), rep(c(""Pooled""), 5), rep(c(""Unpooled""), 5))"
"0","pred2 <- as.data.frame(pred2)"
"0","ggplot(pred2, aes(y=as.factor(Game), pch=Model)) +"
"0","  geom_point(aes(x=Mean), size=3) +"
"0","  scale_shape_manual(values=c(4, 1, 3))+"
"0","  geom_segment((aes(xend=Mean, yend=Game, x=1.96*LB, col=Game, alpha=Game)), size=1.2) +"
"0","  geom_segment((aes(xend=Mean, yend=Game, x=1.96*UB, col = Game, alpha=Game)), size=1.2) + "
"0","  geom_point(aes(x=Mean), size=3) +"
"0","  scale_shape_manual(values=c(4, 1, 3))+"
"0","  theme_minimal() +"
"0","  labs(title=""Partial Pooling with Multi-level Model"") +"
"0","  xlab(""Difference in Points (LAD - BOS)"") + ylab(""World \n Series \n Game"") + xlim(-20, 20) + "
"0","  guides(alpha=FALSE) + guides(col=FALSE)"
